model: vit_base_patch16_224
pretrained: true
use_fp16: true

momentum_teacher: 0.9998
out_dim: 2048
warmup_teacher_temp: 0.04
teacher_temp: 0.04
warmup_teacher_temp_epochs: 0

batch_size_per_gpu: 16
channels_last: true
pin_mem: true
norm_last_layer: true

sched: cosine
lr: 0.0005
min_lr: 0.000001
warmup_lr: 0.001
opt: lookahead_adamw
clip_mode: norm
clip_grad: 3.0

epochs: 100
warmup_epochs: 10
cooldown_epochs: 5

dataset: Flowers102
num_classes: 102
data_dir: ../

log_wandb: true


# lookahead_adamw ------------------------------------------------------------------
# Current checkpoints:
#  ('../results/test_ssl-20220513-081432/checkpoint-101.pth.tar', 7.185025752536834)
#  ('../results/test_ssl-20220513-081432/checkpoint-102.pth.tar', 7.204794285789369)
#  ('../results/test_ssl-20220513-081432/checkpoint-98.pth.tar', 7.210110248081268)
#  ('../results/test_ssl-20220513-081432/checkpoint-100.pth.tar', 7.212013774447971)
#  ('../results/test_ssl-20220513-081432/checkpoint-104.pth.tar', 7.214203993479411)
 
# *** Best metric: 7.185025752536834 (epoch 101)

# adamw ----------------------------------------------------------------------------
# Current checkpoints:
#  ('../results/test_ssl-20220513-150034/checkpoint-101.pth.tar', 7.386821534898546)
#  ('../results/test_ssl-20220513-150034/checkpoint-98.pth.tar', 7.402541433061872)
#  ('../results/test_ssl-20220513-150034/checkpoint-100.pth.tar', 7.405795695289733)
#  ('../results/test_ssl-20220513-150034/checkpoint-95.pth.tar', 7.4083696698385575)
#  ('../results/test_ssl-20220513-150034/checkpoint-99.pth.tar', 7.41072077978225)
#  *** Best metric: 7.386821534898546 (epoch 101)